var MapWinPercentageVisualization;(function(n){function y(){var t=document.getElementById("mapPercentage"),n=Math.min(t.clientWidth/2,b);f.transition().delay(0).duration(0).attr("transform","translate("+n+","+n+")"),u.transition().delay(0).duration(0).attr("transform","scale("+n/1e3+")"),r.transition().delay(0).duration(0).attr("height",n*2).attr("width",n*2)}function p(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t].TimesPlayed);return i}function e(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t].Map);return i}function o(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t].Percentage);return i}function d(n,t){w=n,s=t,g(1e3),y()}function g(n){i=undefined,t=n;var h=[],c=e(h),l=o(h);r=d3.select("#mapPercentage").append("svg").attr("width",t*2).attr("height",t*2).attr("name","mapwinpercentagevisualization"),f=r.append("g").attr("transform","translate("+t+","+t+")"),u=f.append("g").attr("transform","translate("+t+","+t+")"),s.AddHandler(nt,this)}function nt(n){var s,r;if(n!=undefined&&n.MapWinPercentages!=undefined){if(k=n,document.getElementById("mapTitle").innerHTML=n.Name+"'s Win/Loss Data by Map",i==undefined){s=e(n.MapWinPercentages),r=o(n.MapWinPercentages),i=u.selectAll(".group").data(d3.layout.pie()(p(n.MapWinPercentages))).enter().append("g"),h=i.append("title").text(function(t,i){return s[i].Name+" "+r[i]*100+"% of "+n.MapWinPercentages[i].TimesPlayed+" games."}),c=i.append("path").attr("class","lossSlice").attr("d",function(n){return d3.svg.arc().innerRadius(0).outerRadius(t)(n)}).attr("fill",function(n,t){return v(Math.abs(1-r[t]))}),l=i.append("path").attr("class","winSlice").attr("d",function(n,i){return d3.svg.arc().innerRadius(0).outerRadius(t*Math.sqrt(r[i]))(n)}).attr("fill",function(n,t){return a(r[t])});return}var w=e(n.MapWinPercentages),f=o(n.MapWinPercentages),y=d3.layout.pie()(p(n.MapWinPercentages));c.transition().attr("d",function(n,i){return d3.svg.arc().innerRadius(0).outerRadius(t)(y[i])}).attr("fill",function(n,t){return v(Math.abs(1-f[t]))}),l.transition().attr("d",function(n,i){return d3.svg.arc().innerRadius(0).outerRadius(t*Math.sqrt(f[i]))(y[i])}).attr("fill",function(n,t){return a(f[t])}),h.transition().text(function(t,i){return w[i].Name+" "+f[i]*100+"% of "+n.MapWinPercentages[i].TimesPlayed+" games."})}}var w,s,b=240,i,h,c,l,k,r,u,f,t,a=d3.scale.linear().domain([0,1]).range(["#CCCCCC","green"]),v=d3.scale.linear().domain([0,1]).range(["#CCCCCC","red"]);n.resize=y,n.CreateMapWinPercentageVisualization=d})(MapWinPercentageVisualization||(MapWinPercentageVisualization={}))